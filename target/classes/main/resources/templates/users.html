<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>All users</title>
    <link rel="stylesheet" type="text/css" media="all" href="../static/css/main.css" th:href="@{/css/main.css}"/>
    <link rel="stylesheet" type="text/css" media="all" href="../static/css/animatedObjects.css" th:href="@{/css/animatedObjects.css}"/>
    <link rel="stylesheet" type="text/css" media="all" href="../static/css/page.css" th:href="@{/css/page.css}"/>
    <script th:src="@{/js/deleteRows.js}"></script>
</head>
<body>
<div class="moon-wrapper">
    <div class="moon"></div>
</div>
<div class="stars">
</div>
<div class="cloud cloud1"></div>
<div class="cloud cloud2"></div>
<div class="page-wrapper">
    <h2>All users</h2>
    <div th:if="${#lists.isEmpty(users)}">
        <p>No users.</p>
    </div>
    <a class="btn" style="transform: rotate(5deg); left: 32rem; margin-top: -2rem;" th:href="@{/users/add}">Add a new user</a>
    <div class="search-bar">
        <label for="userSearch"></label><input type="text" id="userSearch" placeholder="Search users...">
    </div>
    <a th:href="@{/user-own-page}" style="left: 32rem" class="btn">Back to admin panel</a>
    <p>The dreamers are:</p>

    <div th:each="user : ${users}" style="margin-bottom: 0.5rem; font-family: Arial, sans-serif;">
        <span th:text="${user.username}" style="font-weight: bold; font-family: 'Comic Neue', cursive"></span>
        <a th:href="@{/dreams/view/{id}(id=${user.id})}" style="margin-left: 0.5rem; font-size: 0.9rem; text-decoration: none;">Open</a>
        <a th:href="@{/dreams/edit/{id}(id=${user.id})}" style="margin-left: 0.3rem; font-size: 0.9rem; text-decoration: none;">Edit</a>
        <button th:attr="data-id=${user.id}" onclick="deleteUser(this)" style="margin-left: 0.3rem; font-size: 0.9rem; background: none; border: none; cursor: pointer;">Delete</button>
    </div>

</div>
<script>
    const searchInput = document.getElementById('userSearch');
    const dreamCards = document.querySelectorAll('.user-card');

    searchInput.addEventListener('input', () => {
        const query = searchInput.value.toLowerCase();

        dreamCards.forEach(card => {
            const title = card.querySelector('h4, h3')?.textContent.toLowerCase() || '';
            const description = card.querySelector('h5, p')?.textContent.toLowerCase() || '';

            if (title.includes(query) || description.includes(query)) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        });
    });
</script>
</body>
</html>
